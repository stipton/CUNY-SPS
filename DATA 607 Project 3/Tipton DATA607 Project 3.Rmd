---
title: "DATA 607 Project 3"
author: "Steve Tipton"
date: "March 25, 2018"
output:
  html_document:
    toc: true
    toc_depth: 3  
    theme: united  # "default", "cerulean", "journal", "flatly", "readable", "spacelab", "united", "cosmo", "lumen", "paper", "sandstone", "simplex", "yeti"
    highlight: pygments
editor_options: 
  chunk_output_type: console
---

As the demand for data scientists has grown in the economy, the number of educational programs has also expanded.  For this project, we decided to examine language used in the curricula of a sample of graduate programs to see how the key terms used by educators compare to the key terms found in job postings and resumes.  In other words, *what does academia consider the most important skills for a data scientist?*

To identify the schools in the study, we began with a simple Google search for the "Top Data Scientist Masters Programs."  Our results included the following websites:

* https://www.predictiveanalyticstoday.com/top-predictive-analytics-programs/
* http://www.mastersindatascience.org/schools/top-masters-in-analytics/
* http://starbridgepartners.com/2017/09/23-top-us-schools-offering-a-masters-programs-in-data-science/
* https://www.forbes.com/sites/bernardmarr/2017/05/02/the-6-best-data-science-masters-degree-courses-in-the-us/#4c798a7674a1

We selected a sample of **NEED NUMBER** schools from these lists by choosing the schools with full curriculum and course descriptions available online.  The process of scraping the information was highly manual, as every school formats their data differently and must be tackled fresh.  In the end, while we were able to develop sophisticated code to parse many sites, we did encounter several schools that we eliminated from the sample simply due to the level of scraping required (MIT - we'll be back to battle again!).

### Sample Institutions

|School|Website|Degree|Program Name|
|------|-------|------|------------|
|Michigan State University|http://broad.msu.edu/businessanalytics/|MS|Business Analytics|
|University of Cincinnati|MS|Business Analytics|
|CUNY SPS|MS|Data Science|


### Set up environment and load libraries

```{r, results = "hide", message = FALSE, warning = FALSE}
rm(list = ls())
library(kableExtra)
library(dplyr)
library(class)
library(knitr)
library(RCurl)
library(XML)
library(jsonlite)
library(rvest)
library(stringr)
library(tidyr)
```

### 1. Michigan State University

```{r}
msu <- read_html('https://accounting.broad.msu.edu/academic-programs/ms-business-analytics/course-descriptions/')

msu.classes <- msu %>%
  html_nodes('h2~ ul li') %>% ## using selector gadget
  html_text() %>%
  as.data.frame() 

msu.classes <- msu.classes %>%
  separate(colnames(msu.classes[1]), c("Title","Number"), sep = '\\(', extra = "merge") %>%
  separate(Number, c("Number","Description"), sep = '\\)', extra = "merge")

msu.classes[6,3] <- msu.classes[6,1] %>%
  str_extract(":.*") %>%
  str_remove(":")
msu.classes[6,1] <- msu.classes[6,1] %>%
  str_extract(".*:") %>%
  str_remove(":")

School <- rep("msu", nrow(msu.classes))
msu.classes <- cbind.data.frame(School, msu.classes)
msu.classes[,"Type"] <- character(nrow(msu.classes))
msu.classes[,"Credits"] <- character(nrow(msu.classes))

kable_styling(kable(msu.classes, "html"), bootstrap_options = "striped")
```

### 2. Cincinnati

```{r}
cin <- read_html("https://business.uc.edu/graduate/masters/ms-business-analytics/msba-academics.html")

cin.table <- cin %>% 
  html_nodes("table.table") %>%
  html_table(fill = TRUE, header = TRUE)

cin.classes <- as.data.frame(cin.table[2])

School <- rep("cin", nrow(cin.classes))
cin.classes <- cbind.data.frame(School, cin.classes)

colnames(cin.classes) <- c("School", "Type", "Number", "Title", "Description", "Syllabus")
cin.classes[,"Credits"] <- character(nrow(cin.classes))
cin.classes <- cin.classes[-6]

kable_styling(kable(cin.classes, "html"), bootstrap_options = "striped")
```

### 3. CUNY SPS

I'm such a nerd - when planning my coursework at SPS, I made an Excel sheet with all the courses and their descriptions by hand, copying and pasting from the website.  May as well put it to use!

```{r}
cuny.classes <- read.csv("https://raw.githubusercontent.com/stipton/CUNY-SPS/master/DATA%20607%20Project%203/cuny.classes.csv")

School <- rep("cuny", nrow(cuny.classes))
cuny.classes <- cbind.data.frame(School, cuny.classes)

colnames(cuny.classes) <- c("School", "Type", "Number", "Title", "Description", "Credits", "Prerequisites")

cuny.classes <- cuny.classes[,-7]
cuny.classes$Credits <- as.character(cuny.classes$Credits)

kable_styling(kable(cuny.classes, "html"), bootstrap_options = "striped")
```

### 4. Northwestern

```{r}
norw <- read_html("https://sps.northwestern.edu/masters/data-science/program-courses.php")

norw.links <- norw %>%
  htmlParse() %>%
  xpathSApply("//table//a/@href") %>%
  str_extract_all("/program-courses.*") %>%
  unlist()

norw.classes <- data.frame()

for(i in 1:length(norw.links)) {
  url1 <- "https://sps.northwestern.edu/masters/data-science"
  url2 <- norw.links[i]
  final.url <- paste(url1, url2, sep = "")
  course <- read_html(final.url)
  course.title <- course %>%
    html_nodes('h3') %>%
    html_text()
  norw.classes[i,1] <- course.title
  course.desc <- course %>%
    html_nodes('#main-content p') %>%
    html_text() %>%
    paste(collapse = "")
  norw.classes[i,2] <- course.desc
}

School <- rep("norw", nrow(norw.classes))
norw.classes <- cbind.data.frame(School, norw.classes)

colnames(norw.classes) <- c("School", "Title", "Description")
norw.classes[,"Type"] <- character(nrow(norw.classes))
norw.classes[,"Credits"] <- character(nrow(norw.classes))
norw.classes[,"Number"] <- character(nrow(norw.classes))

kable_styling(kable(norw.classes, "html"), bootstrap_options = "striped")
```

### 5. Arizona State University

```{r}
asu <- read_html("https://wpcarey.asu.edu/masters-programs/business-analytics/curriculum")

asu.titles <- asu %>%
  html_nodes("h3.panel-title") %>% 
  html_text() %>%
  as.character() 

asu.descriptions <- asu %>%
  html_nodes("div.panel-body p") %>%
  html_text() %>%
  as.character()

asu.descriptions[10] <- paste(asu.descriptions[10:12], collapse = "")
asu.descriptions <- asu.descriptions[1:10]

asu.classes <- cbind.data.frame(asu.titles, asu.descriptions)

School <- rep("asu", nrow(asu.classes))
asu.classes <- cbind.data.frame(School, asu.classes)

colnames(asu.classes) <- c("School", "Title", "Description")
asu.classes[,"Type"] <- character(nrow(asu.classes))
asu.classes[,"Credits"] <- character(nrow(asu.classes))
asu.classes[,"Number"] <- character(nrow(asu.classes))

kable_styling(kable(asu.classes, "html"), bootstrap_options = "striped")
```

### 6. Purdue

```{r}
pur <- read_html("http://www.krannert.purdue.edu/masters/programs/business-analytics-and-information-management/curriculum/home.php")

pur.classes <- pur %>%
  html_nodes("h2~ p ,h2 ,h2~ ul li") %>% 
  html_text() %>%
  as.character()

pur.classes <- pur.classes[-c(1,2,3,18,26,39,71:76)]
pur.classes[16] <- paste(pur.classes[16:21], collapse = " ")
pur.classes[39] <- paste(pur.classes[39:40], collapse = " ")
pur.classes[44] <- paste(pur.classes[44:45], collapse = " ")
pur.classes[55] <- paste(pur.classes[55:58], collapse = " ")
pur.classes <- pur.classes[-c(17:21,40,45,56:58)]

pur.titles <- pur.classes[c(TRUE,FALSE)]
pur.desc <- pur.classes[c(FALSE,TRUE)]
pur.classes <- cbind.data.frame(pur.titles, pur.desc)

School <- rep("pur", nrow(pur.classes))
pur.classes <- cbind.data.frame(School, pur.classes)

colnames(pur.classes) <- c("School", "Title", "Description")
pur.classes[,"Type"] <- character(nrow(pur.classes))
pur.classes[,"Credits"] <- character(nrow(pur.classes))
pur.classes[,"Number"] <- character(nrow(pur.classes))

kable_styling(kable(pur.classes, "html"), bootstrap_options = "striped")
```

### 7. University of Maryland

```{r}
umd <- read_html("https://www.rhsmith.umd.edu/programs/ms-business-analytics/academics")

umd.classes <- umd %>%
  html_nodes("p") %>% 
  html_text() %>%
  as.character()

umd.classes <- umd.classes[str_detect(umd.classes, "BU[A-Z]{2} \\d")]

School <- rep("umd", length(umd.classes))
umd.classes <- cbind.data.frame(School, umd.classes)

umd.classes <- umd.classes %>%
  separate(umd.classes, c("Title","Credits"), sep = '\\(', extra = "merge") %>%
  separate(Credits, c("Credits","Description"), sep = '\\):', extra = "merge")

umd.classes[,"Type"] <- character(nrow(umd.classes))
umd.classes[,"Number"] <- character(nrow(umd.classes))

kable_styling(kable(umd.classes, "html"), bootstrap_options = "striped")
```

### 8. Boston University

```{r}
bum <- read_html("http://www.bu.edu/met/programs/graduate/computer-science/data-analytics/")

bum.classes <- bum %>%
  html_nodes(".bu_collapsible_container, .bu_collapsible_section") %>% 
  html_text() %>%
  as.character()

bum.classes <- bum.classes[-c(1,2)]
bum.desc <- bum.classes[c(FALSE,TRUE)]
bum.titles <- bum.classes[c(TRUE,FALSE)]
bum.titles <- str_sub(bum.titles, 1, 45) ## not perfect, but an approximation of titles

School <- rep("bum", length(bum.titles))
bum.classes <- cbind.data.frame(School, bum.titles, bum.desc)

colnames(bum.classes) <- c("School", "Title", "Description")
bum.classes[,"Type"] <- character(nrow(bum.classes))
bum.classes[,"Credits"] <- character(nrow(bum.classes))
bum.classes[,"Number"] <- character(nrow(bum.classes))

kable_styling(kable(bum.classes, "html"), bootstrap_options = "striped")
```

### 9. North Carolina State University

```{r}
ncs <- read_html("http://analytics.ncsu.edu/?page_id=123")

ncs.classes <- ncs %>%
  html_nodes("ul+ h3 , #main li , hr+ h3") %>% 
  html_text() %>%
  as.character()

ncs.classes[2] <- paste(ncs.classes[2:14], collapse = " ")
ncs.classes[16] <- paste(ncs.classes[16:25], collapse = " ")
ncs.classes[27] <- paste(ncs.classes[27:36], collapse = " ")
ncs.classes[38] <- paste(ncs.classes[38:48], collapse = " ")
ncs.classes[50] <- paste(ncs.classes[50:59], collapse = " ")
ncs.classes[61] <- paste(ncs.classes[61:67], collapse = " ")
ncs.classes <- ncs.classes[-c(3:14,17:25,28:36,39:48,51:59,62:67)]

ncs.titles <- ncs.classes[c(TRUE,FALSE)]
ncs.desc <- ncs.classes[c(FALSE,TRUE)]

School <- rep("ncs", length(ncs.titles))
ncs.classes <- cbind.data.frame(School, ncs.titles, ncs.desc)

colnames(ncs.classes) <- c("School", "Title", "Description")
ncs.classes[,"Type"] <- character(nrow(ncs.classes))
ncs.classes[,"Credits"] <- character(nrow(ncs.classes))
ncs.classes[,"Number"] <- character(nrow(ncs.classes))

kable_styling(kable(ncs.classes, "html"), bootstrap_options = "striped")
```

### Union

```{r}
full.school.set.ST <- asu.classes %>%
  union(bum.classes) %>%
  union(cin.classes) %>%
  union(cuny.classes) %>%
  union(msu.classes) %>%
  union(ncs.classes) %>%
  union(norw.classes) %>%
  union(pur.classes) %>%
  union(umd.classes)

kable_styling(kable(full.school.set.ST, "html"), bootstrap_options = "striped")

write.csv(full.school.set.ST, "data607_educationdata_ST.csv")
```

